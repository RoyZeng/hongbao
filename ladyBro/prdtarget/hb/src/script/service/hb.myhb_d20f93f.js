!function(e,t){function a(){i()}function d(){e(document).on("click",".item-detail",function(){return r(e(this)),!1}),e(document).on("click",".send-hb-btn",function(){return $H.toGetGroupHB(),!1}),e(document).on("tap",function(t){var a=t.target,d=e(a),i=d.parent(),r=a.id,o=a.dataset,s=o.eventName;switch(r){case"data-tab-myto":return $H.onlyClass(i,"cur"),n(!0),!1;case"data-tab-myfrom":return $H.onlyClass(i,"cur"),n(),!1;case"data-to-down":return $H.toDownLoad(),!1}switch(s){case"to-app":return $H.toApp(),!1;case"to-bind":return $H.toBuy(),!1}})}function i(){try{s()}catch(e){$H.error("flushMyFromHB no response")}}function r(e){$H.redirect(t.Const.HB_DETAIL,{dirPurseId:e.attr("data-detail-id"),openId:e.attr("data-open-id")})}function n(e){e?(D.hide(),C.hide(),o(),R&&P.show(),H.show()):(H.hide(),P.hide(),s(),N&&C.show(),D.show()),preIsTo=e}function o(){if(!w){var e=[];t.Req.queMyToHB(function(a){if(w=!0,a.openId&&(t.Data.OPEN_ID=a.openId),void 0===a)return $H.tipNetError();data=a.dirPurseList||[];var d,i;if(data.length<=0)return t.ErrorTip({desc:B.format("发"),container:H,afterFn:function(){b.hide(),u(H,{name:"发"})}});for(var r=0,n=data.length;n>r;r++){if(d=data[r],d.path=$H.IMG_HB,d.id=data[r].dirPurseId,d.openId=$.openId,d.reward=d.reward,i=d.receivedTime){var o=i.indexOf(".");-1!=o&&(d.receivedTime=i.substring(0,o))}"ture"===d.isExpired?(d.path=$H.IMG_HB_EXPIRED,d.desc="已过期",d.itemClass="disabled"):d.desc="0"===d.noReceiveNum?I.format("已领完","已获得{0}元奖金红包".format(d.reward)):I.format(h.format(d.receiveNum,d.noReceiveNum),"领取完获得{0}元奖金红包".format(d.reward)),d.prizeMark<=0&&(d.status=""),e.push(l.format(d))}y.empty().append(e.join("")),R=!0,R&&P.show()},{openId:t.Data.OPEN_ID,code:t.Data.CODE})}}function s(){if(!g){var e=[];t.Req.queMyFromHB(function(a){g=!0;var d;if(a.openId&&(t.Data.OPEN_ID=a.openId),void 0!=a.isBindEgo&&c("true"===a.isBindEgo),a=a.normalPurseList||[],a.length<=0)return t.ErrorTip({desc:B.format("赚"),container:D,beforeFn:function(){D.empty()},afterFn:function(){u(D,{name:"领"})}});for(var i=0,r=a.length;r>i;i++){if(d=a[i],d.purseValue=d.purseValue,"1002"===d.exchangeStatus)d.date="已兑换";else{var n=$H.getDate(d.expireTime);d.date=["兑换有效期：","{0}-{1} {2}点".format(n.m,n.d,n.h),"前有效"].join("")}var o=d.shareAccountId===d.accountId,s="2"===d.rewardType;d.purseSourceStr=o?"我的{0}红包".format(s?"普通":"奖励"):d.purseSource+"红包","true"===d.isExpired&&(d.liClass="disabled",d.date="已失效",d.ticketRule=""),e.push(m.format(d))}E.empty().append(e.join("")),N=!0,N&&C.show()},{openId:t.Data.OPEN_ID,code:t.Data.CODE})}}function c(t){e(".tip").remove();var a='<div class="tip"><i></i><p data-event-name="{0}">{1}</p></div>',d=t?a.format("to-bind",'已绑定账号，打开/下载<strong data-event-name="to-app">苏宁易购客户端</strong>去购物。'):a.format("to-bind","绑定苏宁易购账号，快速使用红包。");D.prepend(d)}function u(e,t){var a=T.format(t);e?e.append(a):v.append(a)}function p(){a(),d()}function f(){$H.hideShareBtn(!0)}var l=[' <li class="item {itemClass}"> ','	<a href="javascript:void(0);">                             ','		<div class="title"><div>{activityDesc}</div>        ',"		<span>{receivedTime}</span></div>                                         ",'		<div class="item-detail" data-detail-id="{id}" data-open-id="{openId}">       ','			<img src="{path}"/>                                      ',"			<dl>{desc}</dl>                                                                ",'			<dl class="detail-circle">详情</dl>                                              ',"		</div>                                                                               ","	</a>                                                                                     "," </li>                                                                                 "].join(""),m=['<li class="{liClass}">														',"	<dl>                                                    ","		<dd>{date}</dd>               ",'		<dd class="price">¥<span>{purseValue}</span><em>元</em></dd> ',"	</dl>                                                   ","	<dl>                                                    ","		<dd>来自-<span>{purseSourceStr}</span></dd>             ","		<dd>{ticketRule}</dd>                         ","	</dl>                                                   ","</li>                                                      "].join(""),v=e("body>section"),h='已领取{0}个，还剩下<i class="a1">{1}</i>个',I="<dd>{0}</dd><dd><div>{1}</div></dd> ",H=e(".my-to"),y=H.find("ul"),D=e(".my-from"),E=D.find(">ul"),b=e("footer"),w=!1,g=!1,$=t.Data.URL_PARAM,B="您还没有{0}过红包呢",T='<div class="send-hb-btn"><a href="javascript:void(0);">我要{name}大红包</a></div>',P=e(".myTo-foot"),C=e(".myFrom-foot"),N=!1,R=!1;test("myhb page "+location.href),e(function(){f(),p()})}(Zepto,HB);